## 地址变换和求FAT表大小

页表的页号和块号一一对应

![image-20231214095506605](C:\Users\Pluto\AppData\Roaming\Typora\typora-user-images\image-20231214095506605.png)

首先将134D转化为二进制数字，0001 0011 0100 1101

然后页面大小为1K，就表示大小为2^10，占10位，那么从后往前数，后面10位不用管，表示被占用了，而前面的就是页面的页号，也就是1110 00，转化为10进制也就是4 ，对应的块号为1A，然后将1A转化为6位二进制数，也就是01 1010，然后将页号替换，并加上后面的10位就是结果，01 1010 1101 0011 01 就是134对应的物理地址，最后，将其转为16进制也就是6B4D

对于4K也是同理，就相当于占12位

![image-20231214100907830](C:\Users\Pluto\AppData\Roaming\Typora\typora-user-images\image-20231214100907830.png)

FAT表大小求法

![image-20231214154754168](C:\Users\Pluto\AppData\Roaming\Typora\typora-user-images\image-20231214154754168.png)

FAT表装的是磁盘块，首先求硬盘能装多少磁盘块

在确定多少个磁盘块之后，就能确定有多少个目录

然后用目录大小乘目录数目就是FAT需要的空间

首先540M去除以1K，得到就是540K个磁盘块

540K > 2^19 

所以是2^20次方

也就是用20个二进制位来表示

然后8位一个字节，所以要2.5个字节来表示FAT表表末

最后是2.5乘以540K 就是FAT表需要的存储空间

![image-20231214160333632](C:\Users\Pluto\AppData\Roaming\Typora\typora-user-images\image-20231214160333632.png)

然后对于

是如此，但是有个注意点，算出来1.2G除以1K等于1.2M，用2M也就是2^21次方表示，21位，这里不能用整除（有很多小数），所以这里加位，到24位，也就是3个字节表示，然后3*1.2M就是3.6M

## 分区分配算法

![image-20231217114327247](C:\Users\Pluto\AppData\Roaming\Typora\typora-user-images\image-20231217114327247.png)

初始给分区编号，起始地址，分区大小，还有进程的大小，让你**分配进程的开始地址**

**首次适应算法**



从P0-P4依次进行，找能容纳P0的第一个分区，然后写得P0起始地址为500K，这时注意，分区5的起始地址需要改变，因为加上了P0的进程大小，所以要将分区5向后挪动200K（P0的大小），分区大小变成100K（装入了200K），分区6不变

这些分区不是连续的

**最佳适应算法**



最佳适应区别在于不是从分区1到分区6，而是从小分区到大分区

**next-fit**



和首次适应规则一样，从分区1到后面，但是在分配第二个进程的时候，从上一次分配的分区开始

**最差适应算法**



选最大的先，依次向小（时间更快，但是大分区被分割了，容易导致很多碎片）

==总结，时间最快，用最差适应算法，节约空间，用最佳适应算法，不需要排序分区，用首次适应算法，首次适应优化是next-fit==

![image-20231217120103699](C:\Users\Pluto\AppData\Roaming\Typora\typora-user-images\image-20231217120103699.png)

## **页面置换算法**

![image-20231217120516143](C:\Users\Pluto\AppData\Roaming\Typora\typora-user-images\image-20231217120516143.png)

5页的进程，拥有三个物理块

FIFO算法

FIFO先进来先出去，先进先出算法

长度为5页，表示页面走向只有1-5，直到物理块放满开始替换，然后来模拟一下

| FIFO     | 2    | 3    | 2    | 1    | 5    | 2    | 4    | 5    | 3    | 2    | 5    | 2    |
| -------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| 1        | 2    | 2    | 2    | 2    | 5    | 5    | 5    | 5    | 3    | 3    | 3    | 3    |
| 2        |      | 3    | 3    | 3    | 3    | 2    | 2    | 2    | 2    | 2    | 5    | 5    |
| 3        |      |      |      | 1    | 1    | 1    | 4    | 4    | 4    | 4    | 4    | 2    |
| 是否缺页 | Y    | Y    | N    | Y    | Y    | Y    | Y    | N    | Y    | N    | Y    | Y    |

初始没有2，缺页，放下来

初始没有3，缺页，放下来

初始有2，不缺页，放下来

初始没有1，缺页，放下来，满啦

初始没有5，缺页，放下来，替换最先放入的2（找还在的相同数字最多的）

初始没有2，缺页，放下来

初始没有4，缺页，放下来

后面都是这样推

缺页率 = 9 / 12

LRU算法

LRU叫做最少使用算法

LRU算法，在替换的时候和先进先出算法有区别，区别在于有几个物理块，向左数几个，数到几替换几

比如上面5之后，物理块满啦，需要替换，3个物理块。那么从5向左数，分别是1,2,3，那么替换3，后续一样

OPT算法

最佳置换算法

就是预测最少使用的，原理呢，就是向右找，找最远的，前面有的如果后面没有，也算最远的

比如说还是5开始满啦，替换，5前面是1,2,3，后面没有1，那么1是最远的，或者说，最远使用的，那么替换1，如果有1，那么在1,2,3中找最远的，比如这里最后的3

注意，如果替换的时候，后面都没有前面出现的，替换第一个

## 磁盘调度算法

FCFS，先来先服务，字如其名，先来先服务，磁头移动顺序就是先后顺序

SSTF，最短寻道时间优先，原则是找距离磁头最短的请求，然后移动

SCAN，电梯调度，电梯调度有一个顺序，从小到大或者从大到小，比如开始3500，然后找3500最近的且比它大的，直到没有更大的，然后回到3500，往小的走

CSCAN，循环电梯，其实就是不回到3500，直接从3500前面最小的开始，方向从左向右

## 处理机调度算法

**FCFS**（等待时间长）

到达时间

服务时间

完成时间 依次相加

周转时间 完成时间-到达时间

带权周转时间 周转时间/服务时间

都很好理解，下面那个最短作业，肯定是时间耗时最少的，主要是让带权周转时间变少

**SJF，最短作业优先算法**（快）

首先第一个先来先执行，之后看到达的进程，谁的服务时间短先执行谁

后面一样

![image-20231217132049023](C:\Users\Pluto\AppData\Roaming\Typora\typora-user-images\image-20231217132049023.png)

**高响应比优先**

**响应比=（等待时间+要求服务时间）/ 要求服务时间**

首先执行第一个先到的

然后计算其余响应比

等待时间为第一个执行完的减去到达时间

执行高响应比的进程

## 银行家算法

![image-20231217132307977](C:\Users\Pluto\AppData\Roaming\Typora\typora-user-images\image-20231217132307977.png)

首先检测T0时刻是否安全

流程为，首先用已有资源，找到能够需要的，比如3 3 2 ，找到1 2 2，然后分配给她后，会释放一些资源，与原有资源加和就是第二个进程可以分配的资源

第二问，请求需要小于need，再看available要足够

然后将释放增加，需要减少，已有减少，进行第一问操作即可

![image-20231217133558068](C:\Users\Pluto\AppData\Roaming\Typora\typora-user-images\image-20231217133558068.png)

## PV操作

看视频

semphore m = 1

使用的信号量为1，m是互斥的，即需要pv操作，不能同时使用

生产者，消费者使用empty和full，empty表示可以使用的，full表示初始的

